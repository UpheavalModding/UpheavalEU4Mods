##############################
# Age Overhaul               #
# Age of Discovery           #
#                            #
# Written by von_der_borch   #
##############################

namespace = age_overhaul_age_of_discovery

# Initialization 
country_event = {
	id = age_overhaul_age_of_discovery.0
	title = age_overhaul_age_of_discovery.0.title
	desc = age_overhaul_age_of_discovery.0.desc
	picture = CITY_DEVELOPMENT_eventPicture

	hidden = yes
	mean_time_to_happen = { days = 0 }

	trigger = {
		has_global_flag = age_overhaul_initialized
		NOT = { current_age = age_of_discovery }
		NOT = { has_country_flag = age_overhaul_age_of_discovery_abilities_selected }
		NOT = { has_country_flag = age_overhaul_age_of_discovery_abilities_selecting }
	}

	immediate = {
		hidden_effect = {
			set_country_flag = age_overhaul_age_of_discovery_abilities_selecting

			# set the number of abilities currently selected for carryover
			set_variable = {
				which = age_overhaul_ability_carryover_currently_selected
				value = 0
			}

			# Set the number of abilities that will be allowed to be carried over
			set_variable = {
				which = age_overhaul_ability_carryover_max_abilities
				value = 0
			}

			# Count up all the Abilities that were selected in the last age
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_allow_feudal_de_jure_law
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_justified_wars
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_transfer_vassal_wargoal
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_free_war_taxes
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_cavalry_armies
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_colony_boost_development
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_attack_bonus_in_capital_terrain
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_ottoman_siege_ability
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_portugal_colonial_growth
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_denmark_reduced_lib_desire
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_country_flag = age_overhaul_age_ability_ab_venice_ship_trade
						has_global_flag = age_overhaul_option_skipped_age_of_discovery
					}
				}
				change_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}

			# If the max abilities is greater than what is set for the age, set it down to the max value for the age
			if = {
				limit = {
					check_variable = {
						which = age_overhaul_ability_carryover_max_abilities
						which = age_overhaul_option_max_age_abilities_age_of_discovery
					}
				}

				set_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					which = age_overhaul_option_max_age_abilities_age_of_discovery
				}
			}

			# Helper variable
			set_variable = {
				which = age_overhaul_ability_carryover_max_abilities_invalid
				which = age_overhaul_ability_carryover_max_abilities
			}
			change_variable = {
				which = age_overhaul_ability_carryover_max_abilities_invalid
				value = 1
			}
		}
	}

	# Close the event if it manages to pop up
	option = {
		name = age_overhaul_options_skip
		country_event = { id = age_overhaul_age_of_discovery.1 }
	}
}

# Select Age Abilities to Carryover
country_event = {
	id = age_overhaul_age_of_discovery.1
	title = age_overhaul_age_of_discovery.1.title
	desc = age_overhaul_age_carryover_desc
	picture = CITY_DEVELOPMENT_eventPicture

	is_triggered_only = yes
	
	option = {
		name = age_overhaul_confirm_abilities
		highlight = yes

		trigger = {
			NOT = {
				check_variable = {
					which = age_overhaul_ability_carryover_currently_selected
					which = age_overhaul_ability_carryover_max_abilities_invalid
				}
				AND = {
					check_variable = {
						which = age_overhaul_ability_carryover_max_abilities
						value = 0
					}
					NOT = {
						check_variable = {
							which = age_overhaul_ability_carryover_max_abilities
							value = 1
						}
					}
				}
			}
		}

		hidden_effect = {
			country_event = { id = age_overhaul_age_of_discovery.2 }
		}
	}
	
	option = {
		name = age_overhaul_skip_abilities
		highlight = yes

		ai_chance = { factor = 1000 }
		trigger = {
			check_variable = {
				which = age_overhaul_ability_carryover_max_abilities
				value = 0
			}
			NOT = {
				check_variable = {
					which = age_overhaul_ability_carryover_max_abilities
					value = 1
				}
			}
		}

		hidden_effect = {
			set_country_flag = age_overhaul_age_of_discovery_abilities_selected
		}
	}

	# ab_allow_feudal_de_jure_law
	option = {
		name = age_overhaul_age_of_discovery.1.a.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_allow_feudal_de_jure_law
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_allow_feudal_de_jure_law }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_allow_feudal_de_jure_law
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		tooltip =  age_overhaul_tooltip_ab_allow_feudal_de_jure_law
		#tooltip =  age_overhaul_tooltip_
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.a.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_allow_feudal_de_jure_law
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_allow_feudal_de_jure_law
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_justified_wars
	option = {
		name = age_overhaul_age_of_discovery.1.b.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_justified_wars
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_justified_wars }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_justified_wars
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.b.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_justified_wars
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_justified_wars
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_transfer_vassal_wargoal
	option = {
		name = age_overhaul_age_of_discovery.1.c.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_transfer_vassal_wargoal
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_transfer_vassal_wargoal }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_transfer_vassal_wargoal
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.c.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_transfer_vassal_wargoal
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_transfer_vassal_wargoal
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_free_war_taxes
	option = {
		name = age_overhaul_age_of_discovery.1.d.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_free_war_taxes
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_free_war_taxes }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_free_war_taxes
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.d.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_free_war_taxes
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_free_war_taxes
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_cavalry_armies
	option = {
		name = age_overhaul_age_of_discovery.1.e.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_cavalry_armies
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_cavalry_armies }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_cavalry_armies
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.e.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_cavalry_armies
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_cavalry_armies
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_colony_boost_development
	option = {
		name = age_overhaul_age_of_discovery.1.f.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_colony_boost_development
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_colony_boost_development }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_colony_boost_development
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.f.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_colony_boost_development
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_colony_boost_development
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_attack_bonus_in_capital_terrain
	option = {
		name = age_overhaul_age_of_discovery.1.g.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_attack_bonus_in_capital_terrain
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_attack_bonus_in_capital_terrain }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_attack_bonus_in_capital_terrain
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.g.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_attack_bonus_in_capital_terrain
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_attack_bonus_in_capital_terrain
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_ottoman_siege_ability
	option = {
		name = age_overhaul_age_of_discovery.1.h.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_ottoman_siege_ability
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_ottoman_siege_ability }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_ottoman_siege_ability
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 100 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.h.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_ottoman_siege_ability
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_ottoman_siege_ability
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_portugal_colonial_growth
	option = {
		name = age_overhaul_age_of_discovery.1.i.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_portugal_colonial_growth
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_portugal_colonial_growth }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_portugal_colonial_growth
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 100 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.i.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_portugal_colonial_growth
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_portugal_colonial_growth
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_denmark_reduced_lib_desire
	option = {
		name = age_overhaul_age_of_discovery.1.j.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_denmark_reduced_lib_desire
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_denmark_reduced_lib_desire }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_denmark_reduced_lib_desire
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.j.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_denmark_reduced_lib_desire
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_denmark_reduced_lib_desire
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}

	# ab_venice_ship_trade
	option = {
		name = age_overhaul_age_of_discovery.1.k.e
		
		set_country_flag = age_overhaul_ability_carryover_ab_venice_ship_trade
		trigger = {
			NOT = { has_country_flag = age_overhaul_ability_carryover_ab_venice_ship_trade }
			OR = {
				has_country_flag = age_overhaul_age_ability_ab_venice_ship_trade
				has_global_flag = age_overhaul_option_skipped_age_of_discovery
			}
		}
		ai_chance = { factor = 10 }

		change_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
	option = {
		name = age_overhaul_age_of_discovery.1.k.d
		
		clr_country_flag = age_overhaul_ability_carryover_ab_venice_ship_trade
		trigger = {
			has_country_flag = age_overhaul_ability_carryover_ab_venice_ship_trade
			ai = no
		}
		
		subtract_variable = {
			which = age_overhaul_ability_carryover_currently_selected
			value = 1
		}
		country_event = {
			id = age_overhaul_options_menu_skipper.3
		}
	}
}

# Assign the Bonuses that are Carrying Over
country_event = {
	id = age_overhaul_age_of_discovery.2
	title = age_overhaul_age_of_discovery.2.title
	desc = age_overhaul_age_of_discovery.2.desc
	picture = CITY_DEVELOPMENT_eventPicture

	hidden = yes
	is_triggered_only = yes

	immediate = {
		set_country_flag = age_overhaul_age_of_discovery_abilities_selected

		# ab_allow_feudal_de_jure_law
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_allow_feudal_de_jure_law
			}
			set_country_flag = feudal_de_jure_law
		}

		# ab_justified_wars
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_justified_wars
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_justified_wars
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_justified_wars
					duration = -1
				}
			}
		}

		# ab_transfer_vassal_wargoal
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_transfer_vassal_wargoal
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_transfer_vassal_wargoal
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_transfer_vassal_wargoal
					duration = -1
				}
			}
		}

		# ab_free_war_taxes
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_free_war_taxes
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_free_war_taxes
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_free_war_taxes
					duration = -1
				}
			}
		}

		# ab_cavalry_armies
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_cavalry_armies
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_cavalry_armies
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_cavalry_armies
					duration = -1
				}
			}
		}

		# ab_colony_boost_development
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_colony_boost_development
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_colony_boost_development
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_colony_boost_development
					duration = -1
				}
			}
		}

		# ab_attack_bonus_in_capital_terrain
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_attack_bonus_in_capital_terrain
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_attack_bonus_in_capital_terrain
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_attack_bonus_in_capital_terrain
					duration = -1
				}
			}
		}

		# ab_ottoman_siege_ability
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_ottoman_siege_ability
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_ottoman_siege_ability
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_ottoman_siege_ability
					duration = -1
				}
			}
		}

		# ab_portugal_colonial_growth
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_portugal_colonial_growth
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_portugal_colonial_growth
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_portugal_colonial_growth
					duration = -1
				}
			}
		}

		# ab_denmark_reduced_lib_desire
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_denmark_reduced_lib_desire
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_denmark_reduced_lib_desire
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_denmark_reduced_lib_desire
					duration = -1
				}
			}
		}

		# ab_venice_ship_trade
		if = {
			limit = {
				has_country_flag = age_overhaul_ability_carryover_ab_venice_ship_trade
			}

			# 100%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_100
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_100_ab_venice_ship_trade
					duration = -1
				}
			}

			# 50%
			if = {
				limit = {
					has_global_flag = age_overhaul_option_age_ability_carryover_power_50
				}
				add_country_modifier = {
					name = age_overhaul_age_ability_50_ab_venice_ship_trade
					duration = -1
				}
			}
		}
	}
	
	option = {
		name = age_overhaul_confirm_abilities

		if = {
			limit = {
				has_global_flag = age_overhaul_option_skipped_age_of_reformation
			}

			country_event = { id = age_overhaul_age_of_reformation.0 }
		}
	}

}
